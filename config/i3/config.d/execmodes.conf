# Backup and edit configs
mode "config" {
		# i3 config
		bindsym i mode "i3"
		# Xorg config
		#bindsym x exec bash scripts/xconfig.sh
		# lightdm config
		#bindsym l exec bash scripts/ldmconfig.sh
		# lightdm greeter config
		#bindsym g exec bash scripts/ldmgreetconfig.sh
		# fstab config
		#bindsym f exec bash scripts/fstabconfig.sh
		# crypttab config
		#bindsym c exec bash scripts/crypttabconfig.sh
		# autostart config
		#bindsym a exec bash scripts/autostartconfig.sh
		# sudo config
		#bindsym s exec bash scripts/sudoconfig.sh
		# network config
		#bindsym n exec bash scripts/netconfig.sh
		# dunst config
		#bindsym d exec bash scripts/dunstconfig.sh

		# back to normal: Enter or Escape or $mod+d
		bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym $alt+c mode "default"
}

bindsym $alt+c exec i3-msg workspace "Config" && i3-msg mode "config"

mode "i3" {
		bindsym i exec bash scripts/i3config.sh
		bindsym w exec bash scripts/workspaces.sh
		bindsym b exec bash scripts/baremetal.sh
		bindsym c exec bash scripts/containers.sh
		bindsym e exec bash scripts/execmodes.sh
		bindsym k exec bash scripts/keybinds.sh
		bindsym s exec bash scripts/start.sh
		bindsym v exec bash scripts/vmguest.sh

		# back to normal: Enter or Escape or $mod+Shift+t
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $alt+c mode "default"
}

mode "terminal" {
	        bindsym n exec konsole --profile "Profile 1" --noclose -e neofetch | i3-msg mode "default"
	        bindsym g exec konsole --profile "Profile 1" --noclose -e glances | i3-msg mode "default"
	        bindsym h exec konsole --profile "Profile 1" --noclose -e htop | i3-msg mode "default"
	        bindsym c exec konsole --profile "Profile 1" --noclose -e calc | i3-msg mode "default"
	
	        # back to normal: Enter or Escape or $mod+Shift+t
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $mod+Shift+t mode "default"
}

bindsym $mod+Shift+t mode "terminal"

# sudo mode - will prompt for password - password is ported directly to sudo and not stored in a variable
mode "sudo" {
		bindsym s exec "tmux kill-session -t synaptic_script; sleep 1; tmux new-session -d -s synaptic_script '~/scripts/sudokeybind.sh'; i3-msg mode 'default'"
		bindsym t exec "tmux kill-session -t timeshift_bkp_script; sleep 1; tmux new-session -d -s timeshift_bkp_script '~/scripts/sudokeybind.sh'; i3-msg mode 'default'"
		bindsym d exec "tmux kill-session -t gnomedisks_sudo_script; sleep 1; tmux new-session -d -s gnomedisks_sudo_script '~/scripts/sudokeybind.sh'; i3-msg mode 'default'"
	        bindsym e exec "tmux kill-session -t thunar_sudo_script; sleep 1; tmux new-session -d -s thunar_sudo_script '~/scripts/sudokeybind.sh'; i3-msg mode 'default'"
	        bindsym Return mode "default"
		bindsym Escape mode "default"
		bindsym $mod+Control+s mode "default"
}

bindsym $mod+Control+s exec "i3-msg workspace 'System'; i3-msg mode 'sudo'"

mode "authenticate" {
	        bindsym k exec kleopatra | i3-msg mode "default"
	        bindsym p exec keepass2 | i3-msg mode "default"
	        bindsym b exec snap run bitwarden | i3-msg mode "default"
	        bindsym g exec gnome-authenticator | i3-msg mode "default"
	        bindsym a exec snap run authpass | i3-msg mode "default"
			
	        # back to normal: Enter or Escape or $mod+Shift+a
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $mod+Shift+a mode "default"
}

bindsym $mod+Shift+a mode "authenticate"

mode "text" {
	        bindsym e exec emacs | i3-msg mode "default"
	        bindsym g exec geany | i3-msg mode "default"
	        bindsym s exec sublime-text | i3-msg mode "default"
	        bindsym b exec brackets | i3-msg mode "default"
	
	        # back to normal: Enter or Escape or $mod+t
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $mod+t mode "default"
}

bindsym $mod+t mode "text"

mode "browser" {
	        bindsym b exec brave-browser | i3-msg mode "default"
	        bindsym c exec chromium | i3-msg mode "default"
	        bindsym f exec firefox-esr | i3-msg mode "default"
	        bindsym t exec torbrowser-launcher | i3-msg mode "default"
	        bindsym m exec sh -c '"/home/user/mullvad-browser/Browser/start-mullvad-browser" --detach || ([ !  -x "/home/user/mullvad-browser/Browser/start-mullvad-browser" ] && "$(dirname "$*")"/Browser/start-mullvad-browser --detach)' dummy %k | i3-msg mode "default"
	        bindsym l exec librewolf && sh scripts/exitmode.sh
	
	        # back to normal: Enter or Escape or $mod+b
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $mod+b mode "default"
}

bindsym $mod+b exec i3-msg workspace "Browser" && i3-msg mode "browser"

mode "video" {
	        bindsym 1 exec simplescreenrecorder | i3-msg mode "default"
	        bindsym 2 exec kazam | i3-msg mode "default"
	        bindsym 3 exec kdenlive | i3-msg mode "default"
	        bindsym 4 exec shotcut & i3-msg mode "default"
	        bindsym 5 exec snap run openshot-community | i3-msg mode "default"
	        bindsym 6 exec handbrake | i3-msg mode "default"
	        bindsym 7 exec bash ytdl.sh | i3-msg mode "default"
	
	        # back to normal: Enter or Escape or $alt+v
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $alt+v mode "default"
}

bindsym $alt+v exec i3-msg workspace "Production" && i3-msg mode "video"

mode "dev" {
	        bindsym 1 exec codium | i3-msg mode "default"
	        bindsym 2 exec pycharm-community | i3-msg mode "default"
	        bindsym 3 exec snap run postman & i3-msg mode "default"
	
	        # back to normal: Enter or Escape or $alt+d
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $alt+d mode "default"
}

bindsym $alt+d exec i3-msg workspace "Development" && i3-msg mode "dev"

# NordVPN
# Chromium is required for keybind $mod+F1 to open nordvpn login page. 
# Or you can edit ~/scripts/nordlogin.sh to use another browser but nord login script fails in Brave and Librewolf, even with shields down.
mode "nordvpn" {
	        bindsym p exec sh scripts/nordpause.sh
	        bindsym l exec sh scripts/nordlogin.sh
	        bindsym c exec sh scripts/nordresume.sh
	        bindsym s exec sh scripts/nordstatus.sh
	        bindsym f exec sh scripts/nordpnp.sh
	        bindsym 2 exec sh scripts/norddouble.sh
	
	        # back to normal: Enter or Escape or $mod+n
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym $mod+n mode "default"
}

bindsym $mod+n mode "nordvpn"

# For screenshots install :
# apt-get install maim xclip copyq

mode "screenshot" {
	        ##  Screenshots in files
	        bindsym 1 exec sh scripts/screensave.sh
	        bindsym 2 exec sh scripts/windowsave.sh
	        bindsym 3 exec sh scripts/selectsave.sh
	        ## Screenshots in clipboards
	        bindsym 4 exec sh scripts/screenclip.sh
	        bindsym 5 exec sh scripts/windowclip.sh
	        bindsym 6 exec sh scripts/selectclip.sh
	
	        # back to normal: Enter or Escape or Print
	        bindsym Return mode "default"
	        bindsym Escape mode "default"
	        bindsym Print mode "default"
}
 
bindsym Print mode "screenshot"
